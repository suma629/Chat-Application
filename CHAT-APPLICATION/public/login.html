<!DOCTYPE html>
<html>
    <head>
        <title>Chat Room</title>
        <link rel="icon" href="images/favicon.png">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="css/style.css">
    </head>
    <body>
        <!--  -->
          
        <!--  -->
            <div class="container-fluid">
             <div class="row navbg">
                <img src="images/favicon.png" style="height: 42px;width: 40px; margin-top: 25px;margin-left: 20px;">
                <h1 class="title"> Chat Room </h1>
            </div>
        </div>
        

         <div class="bgimg">
           <div class="container">
           <div class="row">
               <div class="col-sm-3"></div>
               <div class="col-sm-6">
                   <div class="card" style=" height: 25rem ; margin-top: 50px; padding:30px">
                    <div style="font-size: 40px;color:chocolate; text-align:center;">
                       <h2>Login</h2>
                    </div>
    
                    <div style="margin-bottom: 10px;">
                       <label style="font-size: 20px;color:chocolate;">Username</label>
                       <input class="form-control form-control-lg" name="Email" id="email" type="text" placeholder="email" required>
                    </div>
                    <div style="margin-bottom: 10px;">
                       <label style="font-size: 20px;color:chocolate;">Password</label>
                       <input class="form-control form-control-lg" name="password" id="password" type="text" placeholder="PasswordName" required>
                    </div>
                      <div style="text-align: center;">
                        <!-- <input type="button" onclick="login()" > -->
                       <button class="btn btn-info btn-lg" type="submit" style="margin-top: 20px;" onclick="login()">Login</button>
                       <p id="demo"></p>
                      </div>
                      </div>

                </div>
               </div>
               <div class="col-sm-3"></div>
            </div>
       </div>
      </div> 
     <!-- <script src="/js/xhr.js"></script> -->
     <script>
         function login()
{
let Email=document.querySelector('#email');
let Password=document.querySelector('#password');


let xhr=new XMLHttpRequest();
let url="http://localhost:3000/api/user/login";
xhr.open("POST",url,true);

xhr.setRequestHeader("content-Type", "application/json");

var data=JSON.stringify({
   "email": Email.value,
   "password":Password.value
});

xhr.send(data);

//console.log(xhr.responseText)
xhr.onreadystatechange = function () {
     if(xhr.readyState === 4 ) {
         if(xhr.status === 200)
         {
             const authtoken=xhr.responseText;
                //  console.log(authtoken)
         // console.log("Loggedin successfully");
           location.href ="http://localhost:3000/join.html";
         }
         else
         {
           console.log(xhr.responseText)
         document.getElementById("demo").innerHTML="Oops! "+xhr.responseText;
         }
     }
 }
}

     </script>
     <!-- <script src="/socket.io/socket.io.js"></script>
      <script src="/js/chat.js"></script> -->
      </body>
</html>  